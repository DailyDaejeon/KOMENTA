<template>
    <div class="container">
        <div class="container__following">
            <!-- 버튼 누르기 -->
            <div class="btn-cover_people">
                <button :disabled="pageNum === 0" @click="prevPage" class="page-btn_people">
                    <font-awesome-icon :icon="['fas', 'angle-left']"/>
                </button>
            <!-- 프로필 팔로잉 사진 목록 -->
            <div class="container__following__Profle">
                <div v-for="(user,index) in paginatedData" :key="index">
                    <div @click="gotoFeed(user.f_id)" class="container__following__Profle__background"><img :src="getProfile(index)" class="container__following__Profle__img" width="100px" height="100px"></div>
                </div>
            </div>
            <button :disabled="pageNum >= pageCount-1" @click="nextPage" class="page-btn_people">
                <font-awesome-icon :icon="['fas', 'angle-right']"/>
            </button>
            </div>
            
            <!-- 친구 카드 프로필 닉네임 같이 보여주면서 바로가기 -->
            <div class="at-section">
                <div class="at-section__title"><span class="at-section__nickname">{{userInfo.u_nickname}}</span>님의 친구들의 새로운 소식을 확인해보세요</div>
                <span class="at-section__subtitleButton"><span class="at-section__subtitle"><i class="fas fa-check at-section__icon"></i>친구들의 플레이리스트를 확인하고, 취향에 맞는 VOD를 추천받아보세요!</span></span>
            </div>
            <div class="btn-cover_people">
                <button :disabled="pageNum_2 === 0" @click="prevPage_2" class="page-btn_people" style="margin: 4.5rem 2rem">
                    <font-awesome-icon :icon="['fas', 'angle-left']"/>
                </button>
            <div class="at-grid basic-scroll">
                <div class="at-column" v-for="(user,index) in paginatedData_people" :key="index">
                    <div class="at-user"  @click="gotoFeed(user.f_id)">
                        <div class="at-user__name">{{user.u_nickname}}</div>
                        <div class="at-user__profile"><img :src="getProfile(index)" width="50px" height="50px" class="at-user__profile__img"></div>
                    </div>
                </div>
            </div>
            <button :disabled="pageNum_2 >= pageCount_2 -1" @click="nextPage_2" class="page-btn_people" style="margin: 4.5rem 2rem">
                <font-awesome-icon :icon="['fas', 'angle-right']"/>
            </button>
            </div>
            
            <!-- 여기는 최근 올린 유저들 영상 칸 -->
            <!-- <div class="at-section">
                <div class="at-section__title"><span class="at-section__nickname">{{userInfo.u_nickname}}</span>님의 친구들의 새로운 소식을 확인해보세요</div>
                <span class="at-section__subtitleButton"><span class="at-section__subtitle"><i class="fas fa-check at-section__icon"></i>친구들의 플레이리스트를 확인하고, 취향에 맞는 VOD를 추천받아보세요!</span></span>
            </div>
            <div class="btn-cover_people">
                <button :disabled="pageNum_2 === 0" @click="prevPage_2" class="page-btn_people" style="margin: 4.5rem 2rem">
                    <font-awesome-icon :icon="['fas', 'angle-left']"/>
                </button>
            <div class="at-grid basic-scroll">
                <div class="at-column" v-for="(user,index) in paginatedData_people" :key="index">
                    <div class="at-user"  @click="gotoFeed(user.f_id)">
                        <div class="at-user__name">{{user.u_nickname}}</div>
                        <div class="at-user__profile"><img :src="getProfile(index)" width="50px" height="50px" class="at-user__profile__img"></div>
                    </div>
                </div>
            </div>
            <button :disabled="pageNum_2 >= pageCount_2 -1" @click="nextPage_2" class="page-btn_people" style="margin: 4.5rem 2rem">
                <font-awesome-icon :icon="['fas', 'angle-right']"/>
            </button>
            </div> -->
            
            
            <!-- <div class="at-section">
                <div class="at-section__title popular-title at-section__nickname">KOMENTA TOP9 DJ</div>
                <span class="at-section__subtitle">{{userInfo.u_nickname }}님의 취향에 맞는 스트리밍DJ를 팔로우해보세요!</span>
            </div>
            <div class="btn-cover_people">
                <button class="page-btn_people" style="margin: 4.5rem 2rem">
                    <font-awesome-icon :icon="['fas', 'angle-left']"/>
                </button>
            <div class="at-grid basic-scroll">
                <h1>{{top9}}</h1>
                <div class="at-column" v-for="(user,index) in top9" :key="index">
                    <div class="at-user">
                        <div class="at-user__name">{{user.u_nickname}}</div>
                        <div class="at-user__profile"><img :src="getProfile(index)" width="50px" height="50px" class="at-user__profile__img"></div>
                    </div>
                </div>
            </div>
            <button class="page-btn_people" style="margin: 4.5rem 2rem">
                <font-awesome-icon :icon="['fas', 'angle-right']"/>
            </button>
            </div> -->
        </div>
    </div>

</template>

<script>
import { top9followers,fetchfollowinglist,updateFollowPlaylist } from '@/api/user'
// import { mapState } from 'vuex'
import store from '@/stores/modules/user'

export default {
    data() {
        return {
            pageNum:0,
            pageNum_2:0,
            following_list:[],
            top9:[],
            updateFollowPlaylist:[],
            // pageSize:5,
        }
    },
    props: {
        pageSize: {
            type: Number,
            required: false,
            default: 7
        },
        pageSize_2: {
            type: Number,
            required: false,
            default: 5
        }
    },
    computed: {
        userInfo() {
            return store.state.userInfo;
        },
        pageCount() {
            let listLeng = this.following_list.length,
            listSize = this.pageSize,
            page = Math.floor(listLeng / listSize);

            if(listLeng % listSize > 0) page += 1;

            return page;
        },
        pageCount_2() {
            let listLeng_2 = this.following_list.length,
            listSize_2 = this.pageSize_2,
            page_2 = Math.floor(listLeng_2 / listSize_2);

            if(listLeng_2 % listSize_2 > 0) page_2 += 1;

            return page_2;
        },
        paginatedData() {
            const start = this.pageNum * this.pageSize,
            end = start + this.pageSize;

            return this.following_list.slice(start, end);
            
        },
        paginatedData_people() {
            const start_2 = this.pageNum_2 * this.pageSize_2,
            end_2 = start_2 + this.pageSize_2;

            return this.following_list.slice(start_2, end_2);
            
        },
        
    },
    created() {
        this.getTopInfluencer()
        this.getFollowing()
        // this.getUpdateFollowPlaylist()
       
    },
    methods: {
        gotoFeed(userId) {
            this.$router.push(`/feed/${userId}`)
        },
        nextPage() {
            this.pageNum += 1;
        },
        prevPage() {
            this.pageNum -= 1;
        },
        nextPage_2() {
            this.pageNum_2 += 1;
        },
        prevPage_2() {
            this.pageNum_2 -=1;
        },
        getProfile(index) {
            const profile = this.following_list[index].u_profile_pic.split('.')[0]
            console.log(`${process.env.VUE_APP_PICTURE}profile/${profile}`)
            return `${process.env.VUE_APP_PICTURE}profile/${profile}`;
        },
        async getUpdateFollowPlaylist() {
            const response = await updateFollowPlaylist()
            console.log(response.data,'리스펀스 데이타 ㅋㅋㅋ')
            this.updateFollowPlaylist = response.data
        },
        async getFollowing() {
            const userId = store.state.userInfo.u_id
            const response = await fetchfollowinglist(userId)
            this.following_list = response.data
        },
        async getTopInfluencer() {
            const response = await top9followers()
            console.log(response,'리스펀스,,?')
            console.log(response.data,'들어오잖아?')
            this.top9 = response.data
            console.log(this.top9,'탑나인 내놔')
        },
    },
}
</script>

<style>

